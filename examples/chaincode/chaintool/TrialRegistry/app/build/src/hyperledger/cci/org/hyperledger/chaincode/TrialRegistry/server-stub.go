/* Generated by chaintool.  DO NOT EDIT */

package TrialRegistry

import (
	"encoding/base64"
	"errors"
	"github.com/golang/protobuf/proto"
	"github.com/hyperledger/fabric/core/chaincode/shim"
	"hyperledger/ccs/api"
)

type CCInterface interface {
	AddEntry(*shim.ChaincodeStub, *HashMap) error
	RemoveEntry(*shim.ChaincodeStub, *HashMap) error
	GetTrialClinics(*shim.ChaincodeStub, *HashMap) (*HashMap, error)
	GetTrials(*shim.ChaincodeStub, *Empty) (*HashMap, error)
}

type stubImpl struct {
	intf CCInterface
}

// Factory mechanics
type factoryImpl struct {
}

func init() {
	self := &factoryImpl{}
	api.Register("org.hyperledger.chaincode.TrialRegistry", self)
}

func (self *factoryImpl) Create(intf interface{}) (api.Dispatcher, error) {
	return &stubImpl{intf: intf.(CCInterface)}, nil
}

func (self *stubImpl) DispatchTxn(stub *shim.ChaincodeStub, function int, params string) ([]byte, error) {
	// Handle different functions
	switch {
	case function == 1:
		return self.proxyAddEntry(stub, params)
	case function == 2:
		return self.proxyRemoveEntry(stub, params)
	default:
		return nil, errors.New("Received unknown function invocation")
	}
}

func (self *stubImpl) DispatchQuery(stub *shim.ChaincodeStub, function int, params string) ([]byte, error) {
	// Handle different functions
	switch {
	case function == 1:
		return self.proxyGetTrialClinics(stub, params)
	case function == 2:
		return self.proxyGetTrials(stub, params)
	default:
		return nil, errors.New("Received unknown function invocation")
	}
}

/* Server stubs */
func (self *stubImpl) proxyAddEntry(stub *shim.ChaincodeStub, _params string) ([]byte, error) {

	params := &HashMap{}
	_pbinput, err := base64.StdEncoding.DecodeString(_params)
	if err != nil {
		return nil, err
	}
	err = proto.Unmarshal(_pbinput, params)
	if err != nil {
		return nil, err
	}

	err = self.intf.AddEntry(stub, params)
	if err != nil {
		return nil, err
	}

	return nil, nil
}

func (self *stubImpl) proxyRemoveEntry(stub *shim.ChaincodeStub, _params string) ([]byte, error) {

	params := &HashMap{}
	_pbinput, err := base64.StdEncoding.DecodeString(_params)
	if err != nil {
		return nil, err
	}
	err = proto.Unmarshal(_pbinput, params)
	if err != nil {
		return nil, err
	}

	err = self.intf.RemoveEntry(stub, params)
	if err != nil {
		return nil, err
	}

	return nil, nil
}

func (self *stubImpl) proxyGetTrialClinics(stub *shim.ChaincodeStub, _params string) ([]byte, error) {

	params := &HashMap{}
	_pbinput, err := base64.StdEncoding.DecodeString(_params)
	if err != nil {
		return nil, err
	}
	err = proto.Unmarshal(_pbinput, params)
	if err != nil {
		return nil, err
	}

	result, err := self.intf.GetTrialClinics(stub, params)
	if err != nil {
		return nil, err
	}

	_pboutput, err := proto.Marshal(result)
	if err != nil {
		return nil, err
	}
	_result := base64.StdEncoding.EncodeToString(_pboutput)
	return []byte(_result), nil
}

func (self *stubImpl) proxyGetTrials(stub *shim.ChaincodeStub, _params string) ([]byte, error) {

	params := &Empty{}
	_pbinput, err := base64.StdEncoding.DecodeString(_params)
	if err != nil {
		return nil, err
	}
	err = proto.Unmarshal(_pbinput, params)
	if err != nil {
		return nil, err
	}

	result, err := self.intf.GetTrials(stub, params)
	if err != nil {
		return nil, err
	}

	_pboutput, err := proto.Marshal(result)
	if err != nil {
		return nil, err
	}
	_result := base64.StdEncoding.EncodeToString(_pboutput)
	return []byte(_result), nil
}
